/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Nextflow config file for testing LONG-READ mode with local test data
    Use this config after running generate_longread_test_data.sh

    Use as follows:
        nextflow run . -profile test_longread_local,<docker/singularity> --outdir <OUTDIR>

----------------------------------------------------------------------------------------
*/

process {
    resourceLimits = [
        cpus: 4,
        memory: '7.GB',  // Reduced from 15.GB to fit available memory
        time: '1.h'
    ]
    
    // Reduce memory for specific processes
    withName: '.*:QUANTIFY_SCRNA_ISOQUANT:SPLIT_FASTA' {
        memory = '4.GB'
    }
    
    withName: '.*:QUANTIFY_SCRNA_ISOQUANT:SAMTOOLS_FAIDX_SPLIT' {
        memory = '2.GB'
    }
    
    withLabel:process_low {
        memory = '4.GB'
    }
    
    // Reduce memory for FASTQC
    withName: '.*:FASTQC' {
        memory = '2.GB'
    }
    
    // Reduce memory for other QC tools
    withName: '.*:NANOPLOT' {
        memory = '2.GB'
    }
    
    withName: '.*:TOULLIGQC' {
        memory = '2.GB'
    }
}

params {
    config_profile_name        = 'Test profile - Long-read (Local)'
    config_profile_description  = 'Test dataset with locally generated long-read data'

    // Input type
    input_type                  = 'long_read'

    // Input data - Use locally generated test data
    input                       = "${projectDir}/test_data/longread/samplesheet_longread.csv"

    // Genome references (using small test reference)
    genome_fasta                = "https://raw.githubusercontent.com/nf-core/test-datasets/scnanoseq/reference/chr21.fa"
    gtf                         = "https://raw.githubusercontent.com/nf-core/test-datasets/scnanoseq/reference/chr21.gtf"

    // Barcode options
    barcode_format              = "10X_3v3"

    // Analysis options
    quantifier                  = "isoquant"

    // Skip some steps for faster testing
    skip_seurat                 = true
    skip_multiqc               = false
    skip_dedup                 = false
    skip_trimming              = true   // Skip trimming for test data

}
