# 测试脚本状态说明

## 当前状态解释

当你运行 `bash quick_test.sh` 时，脚本会执行以下步骤：

### 1. 前置条件检查 ✓
- 检查 Nextflow 是否安装
- 检查 VAT 二进制文件是否存在

### 2. Long-Read 模式验证（当前步骤）
**状态：正在运行 Nextflow 命令**

脚本正在执行：
```bash
nextflow run . -profile test_longread,docker --outdir test_output/longread_dryrun
```

**这个过程可能需要一些时间，因为：**
- Nextflow 需要解析整个工作流结构
- 需要验证所有参数和配置
- 可能需要下载 Docker 容器镜像（如果是第一次运行）
- 需要检查输入文件是否存在

**正常现象：**
- 脚本看起来"卡住"了，但实际上正在后台运行
- 第一次运行可能需要 1-5 分钟
- 后续运行会更快（因为容器已缓存）

**你应该看到：**
- Nextflow 的启动信息
- 参数摘要（Input/output options, Reference genome options 等）
- 工作流开始执行的日志

### 3. Short-Read 模式验证
- 同样的过程，但使用 short-read 配置

### 4. 测试总结
- 显示两个模式的验证结果

## 如果脚本卡住太久

如果脚本运行超过 5-10 分钟没有任何输出，可能是：

1. **网络问题**：正在下载容器镜像或测试数据
   - 解决方案：等待，或检查网络连接

2. **Docker 问题**：Docker 服务未运行
   - 检查：`docker ps`
   - 解决方案：启动 Docker 服务

3. **资源问题**：系统资源不足
   - 检查：`top` 或 `htop`
   - 解决方案：等待其他进程完成

## 更快的验证方法

如果你只想快速检查文件结构和语法（不实际运行工作流），可以使用：

```bash
./quick_validate.sh
```

这个脚本会：
- 检查所有必需文件是否存在
- 验证 Nextflow 语法
- 不实际运行工作流
- 通常在几秒内完成

## 查看详细日志

如果 `quick_test.sh` 正在运行，你可以：

1. **查看实时输出**：脚本会显示 Nextflow 的输出

2. **查看日志文件**（在另一个终端）：
   ```bash
   tail -f /tmp/longread_test.log
   tail -f /tmp/shortread_test.log
   ```

3. **检查进程状态**：
   ```bash
   ps aux | grep nextflow
   ```

## 预期输出示例

正常情况下，你应该看到类似这样的输出：

```
==========================================
Test 1: Long-Read Mode (Syntax Validation)
==========================================

Running: nextflow run . -profile test_longread,docker --outdir test_output/longread_dryrun
This may take a moment as Nextflow parses the workflow and validates parameters...

 N E X T F L O W   ~  version 25.04.6

Launching `./main.nf` [friendly_montalcini] DSL2 - revision: 8672f793b7

------------------------------------------------------
  nf-core/scnanoseq 1.2.1
------------------------------------------------------
Input/output options
  input                     : https://raw.githubusercontent.com/...
  outdir                    : test_output/longread_dryrun
  input_type                : long_read
...

✓ Long-read mode: Workflow structure validated (parameters parsed successfully)
```

## 建议

1. **第一次运行**：耐心等待 5-10 分钟，让 Nextflow 下载必要的容器和数据

2. **后续运行**：应该会快很多（1-2 分钟）

3. **如果只是想验证结构**：使用 `./quick_validate.sh` 更快

4. **完整测试**：使用 `./test_longread_shortread.sh both` 进行完整的功能测试
